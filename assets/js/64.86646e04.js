(window.webpackJsonp=window.webpackJsonp||[]).push([[64],{485:function(e,t,_){"use strict";_.r(t);var v=_(56),o=Object(v.a)({},(function(){var e=this,t=e.$createElement,_=e._self._c||t;return _("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[_("h1",{attrs:{id:"登录"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#登录"}},[e._v("#")]),e._v(" 登录")]),e._v(" "),_("h2",{attrs:{id:"_1、静态登录"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#_1、静态登录"}},[e._v("#")]),e._v(" 1、静态登录")]),e._v(" "),_("p",[e._v("考虑web场景下的"),_("code",[e._v("免密码")]),e._v("登录的实现：本地存储长期"),_("code",[e._v("token")]),e._v("。")]),e._v(" "),_("p",[e._v("微信小程序也能这样设计，因为也是有localStorage可以用来存储token的。但这样就体现不了微信的本身优势了，微信号本身就是一种用户凭证。")]),e._v(" "),_("p",[e._v("曾经我处理过这样一个业务问题：")]),e._v(" "),_("p",[e._v("使用微信小程序通过"),_("code",[e._v("webview")]),e._v("嵌入"),_("code",[e._v("H5")]),e._v("页面，首次登录使用被嵌入应用本身的业务账号和密码，选择绑定微信账号后，之后实现静态登录，好处是永远不用再考虑"),_("code",[e._v("token")]),e._v("过期的问题。")]),e._v(" "),_("p",[e._v("根据小程序的设计规则，我的实现如下：")]),e._v(" "),_("p",[e._v("用户首次登录成功后，后端返回必要的登录信息"),_("code",[e._v("token")]),e._v("（注意该token是为了和web端保持行为一致），弹窗提示是否绑定到当前微信号，一旦用户同意绑定，小程序端通过"),_("code",[e._v("wx.login()")]),e._v("获取当前用户的临时凭证"),_("code",[e._v("code")]),e._v("，将code连同usercode发往后端，该后端可以拿着code向指定的微信服务器换取真实唯一的"),_("code",[e._v("openid")]),e._v("，之后与usercode一同存到数据库（往后的登录验证方式也是如此）。使用这种方式还需要web端提供合适的跳转页面来支持。")])])}),[],!1,null,null,null);t.default=o.exports}}]);