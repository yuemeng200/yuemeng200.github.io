# 登录

## 1、静态登录

考虑web场景下的`免密码`登录的实现：本地存储长期`token`。

微信小程序也能这样设计，因为也是有localStorage可以用来存储token的。但这样就体现不了微信的本身优势了，微信号本身就是一种用户凭证。

曾经我处理过这样一个业务问题：

使用微信小程序通过`webview`嵌入`H5`页面，首次登录使用被嵌入应用本身的业务账号和密码，选择绑定微信账号后，之后实现静态登录，好处是永远不用再考虑`token`过期的问题。

根据小程序的设计规则，我的实现如下：

用户首次登录成功后，后端返回必要的登录信息`token`（注意该token是为了和web端保持行为一致），弹窗提示是否绑定到当前微信号，一旦用户同意绑定，小程序端通过`wx.login()`获取当前用户的临时凭证`code`，将code连同usercode发往后端，该后端可以拿着code向指定的微信服务器换取真实唯一的`openid`，之后与usercode一同存到数据库（往后的登录验证方式也是如此）。使用这种方式还需要web端提供合适的跳转页面来支持。