# 第4章 进入vue原理
## 1、响应式原理
### (1) 对象的变化侦测
实现响应式的关键在于把所有数据及其属性变为可被侦测到的，即在`get`和`set`时能被监测到，对于每一个对象通过`Observer`类来实现，其使用`walk()`递归遍历对象的所有层级，通过`defineReactive()`调用`Object.defineProperty()`来实现。对于每一个状态，有唯一的`Dept`用来管理所有的依赖，之后在`get`时收集依赖，在`set`时通知依赖更新。这个依赖是什么呢？可能是一段`template`或者一个`watch`等等，无论什么东西我们都用一个`Watcher`实例来代理，于是在状态发生变化时通知这个代理即可，由其再去触发生成新的`虚拟dom`，通过对比新旧`VNode`，最小化更新真实dom。
### (2) 数组的变化侦测
数组本身的变化侦测和对象有差异，因为我们使用方法来改变数组元素。为了不污染全局`Array.prototype`，只对需要变化侦测的数组使用拦截器作为`__proto__`来覆盖原型方法，对于不支持`__proto__`的浏览器，直接遍历拦截器的方法设置即可。
### (3) vm.$watch的实现
[待看](https://weread.qq.com/web/reader/f8632810723f0231f86d9aakd3d322001ad3d9446802347)
>响应式发挥作用的前提只针对`data`中初始存在的数据。同时对于给对象添加、删除属性以及给数组元素赋新值也无法触发`set`，因为在`ES6`之前，js没有提供可以侦测到这种变化的`元编程`的能力。此时需要`Vue.set(obj, property/index, value)`和`Vue.delete()`手动加入响应式系统。
[原理图](https://cn.vuejs.org/images/data.png)
## 2、虚拟dom
不原生html+js的前端页面也是有状态的，页面中使用的数据即是状态，当我们想要改变状态时，需要手动去更改使用这些状态的dom，因为dom和状态是没有依赖关系的。
## 3、Diff算法

